<doctype html>
<body>
<style>

*{
	padding:0;
	margin:0;
	border:0;
}


.box{
	width:46px;
	height:46px;
	background-color:orange;
	border:2px solid crimson;
	border-radius:15%;	
}

.cont {	
	padding:10px;
	width: 50px;
	height: 50px;
	border: 1px solid black;
		

	position:absolute;
	top:100px;
	left:100px;
	transition: .3s;
}
</style>

<script>
let MOUSEUP;
let dr;   //step for box moving 
let mrgn; //collision objects overlap  = -20; //, //bh = b.clientHeight;
let conts;//opacity elements  that contains colliding objects

window.onload = function(){
	MOUSEUP = true;
	dr = 10;
	mrgn = -20;

	conts = document.getElementsByClassName("cont");
	// boxes = [...conts];

	for (let c of conts){
		//c.addEventListener("mouseenter",onmouseenter);
		c.addEventListener("mousemove",onmouseenter);

	}
	document.onmousedown = () => MOUSEUP=false;
	//addEventListener("mousedown",onmousedown);
	document.onmouseup = () => MOUSEUP = true;
	//addEventListener("mouseup",onmouseup);
}

function in_area(val,cntr,dx=15){
	let min = cntr - dx,
		max = cntr + dx;
	return  min<=val && val<=max;

}

function onmouseenter(e){
	let w = this.clientWidth;
	let h = this.clientHeight;

	if ( in_area(e.offsetX,0) && MOUSEUP)
		if (!collides(this,conts,dr))
			this.style.left = this.offsetLeft + dr + 'px';

	if ( in_area(e.offsetX,w ) && MOUSEUP)
		if (!collides(this,conts,-dr))
			this.style.left = this.offsetLeft - dr + 'px';	

	if ( in_area(e.offsetY,0) && MOUSEUP)
		if (!collides(this,conts,0,dr))
			this.style.top = this.offsetTop + dr + 'px';

	if ( in_area(e.offsetY,h) && MOUSEUP )
		if (!collides(this,conts,0,-dr))
			this.style.top = this.offsetTop - dr + 'px';	
}

function collide(a,b,dx = 0,dy = 0){
	let ax = a.offsetLeft+dx,   bx = b.offsetLeft,
		ay = a.offsetTop+dy,    by = b.offsetTop,
		aw = a.clientWidth,  //bw = b.clientWidth,
		ah = a.clientHeight;
		

	if (a===b)
		return false;
	return (Math.abs(ax-bx)<=aw+mrgn) && (Math.abs(ay-by)<=ah+mrgn);
}

function collides(a,bs,dx=0,dy=0){
	for (let b of bs)
		if (collide(a,b,dx,dy))
			return true
	return false;
}

// function onmouseup(e){
// 	MOUSEUP = true;
// }

// function onmousedown(e){
// 	MOUSEUP = false;
// }



</script>


<div class="cont">
	<div class="box"></div>
</div>

<div class="cont" style="left:200px">
	<div class="box"></div>
</div>

<div class="cont" style="left:200px; top:10px;">
<!-- <div class="top"></div> -->
	<div class="box"></div>

<!-- <div class="top"></div> -->

</div>


</body>